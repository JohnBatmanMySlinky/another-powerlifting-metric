---
title: "open-powerlifting-GAM"
author: "John Myslinski"
output: html_notebook
---
# setup
```{r setup, results = 'hide', warning=FALSE}
rm(list = ls())

library(dplyr)
library(ggplot2)
library(mgcv)
```

# download data
```{r download, results = 'hide', warning=FALSE}
if (file.exists("openpowerlifting-2020-06-20/openpowerlifting-2020-06-20.csv")){
  data.working <- read.csv("openpowerlifting-2020-06-20/openpowerlifting-2020-06-20.csv")
} else {
  download.file("https://github.com/sstangl/openpowerlifting-static/raw/gh-pages/openpowerlifting-latest.zip",
              "openpowerlifting-latest.zip")
  unzip("openpowerlifting-latest.zip")
  
  data.working <- read.csv("openpowerlifting-2020-06-20/openpowerlifting-2020-06-20.csv")
}




```

# Glimpse & summary data
```{r glimpse}
glimpse(data.working)
summary(data.working)
```

# filter data
```{r}
data.working <- data.working %>%
  filter(Event == "SBD",
         Equipment == "Raw",
         !is.na(Age),
         !is.na(BodyweightKg),
         !is.na(TotalKg),
         ParentFederation == "IPF")
```

# creating features
```{r}
data.working <- data.working %>%
  mutate(AgeBucket = as.factor(case_when(
         Age <= 19 ~ "Younger",
         Age >= 20 & Age <= 23 ~ "Junior",
         Age >= 24 & Age <= 35 ~ "Open",
         Age >= 36 ~ "Master",
         TRUE ~ "ERROR"))) %>%
  mutate(Federation = as.factor(Federation))


# testing this worked
data.working %>%
  group_by(WeightClassKg_WORKING,Sex) %>%
  summarise(min = min(BodyweightKg),
            max = max(BodyweightKg))

```

```{r}
# BOX COX TRANSFORMATIONS BY WEIGHT CLASS
```






